# =============================================================================
# PyMOL Script for Mol1 - HOMO/LUMO Visualization
# Generated by Enhanced HOMO-LUMO Pipeline
# =============================================================================

# Setup for publication quality
set ray_trace_mode, 1
set antialias, 2
set ray_opaque_background, off
set depth_cue, 0
set spec_reflect, 0
set shininess, 0
set ambient, 0.4
set direct, 0.6
set reflect, 0.0
set specular, 0.0

# Background and lighting
bg_color white
set light_count, 2
set_color nature_red, [214, 39, 40]
set_color nature_blue, [31, 119, 180] 
set_color nature_gray, [127, 127, 127]

# Load molecular structure
load molecule.pdb, Mol1
hide everything, Mol1
show sticks, Mol1
set stick_radius, 0.15, Mol1
set stick_transparency, 0.0, Mol1

# Beautiful atom colors
util.cbaw Mol1
color gray70, (elem C and Mol1)
color white, (elem H and Mol1)
color red, (elem O and Mol1)
color blue, (elem N and Mol1)
color yellow, (elem S and Mol1)

# Load orbital cube files
load homo.cube, homo_map
load lumo.cube, lumo_map

# HOMO orbital surfaces (positive and negative phases)
isosurface homo_pos, homo_map, 0.03
isosurface homo_neg, homo_map, -0.03
color nature_red, homo_pos
color salmon, homo_neg
set transparency, 0.3, homo_pos
set transparency, 0.3, homo_neg

# LUMO orbital surfaces (positive and negative phases)  
isosurface lumo_pos, lumo_map, 0.03
isosurface lumo_neg, lumo_map, -0.03
color nature_blue, lumo_pos
color lightblue, lumo_neg
set transparency, 0.3, lumo_pos
set transparency, 0.3, lumo_neg

# Initial view setup
orient Mol1
zoom Mol1, 3.0
set orthoscopic, 1

# =============================================================================
# Scene 1: HOMO orbital
# =============================================================================
disable lumo_pos
disable lumo_neg
enable homo_pos
enable homo_neg
enable Mol1

# Add energy label
pseudoatom homo_label, pos=[0,0,0]
label homo_label, "HOMO: -7.40 eV"
set label_size, 20
set label_font_id, 7
set label_color, nature_red
set label_position, [0, 5, 0]
hide everything, homo_label

scene homo_view, store

# High-quality render
set ray_trace_frames, 1
ray 600, 450
png Mol1_HOMO_publication.png, dpi=300

# =============================================================================  
# Scene 2: LUMO orbital
# =============================================================================
disable homo_pos
disable homo_neg
disable homo_label
enable lumo_pos
enable lumo_neg

# Add energy label
pseudoatom lumo_label, pos=[0,0,0]
label lumo_label, "LUMO: 2.23 eV"
set label_color, nature_blue
hide everything, lumo_label

scene lumo_view, store

# High-quality render
ray 600, 450
png Mol1_LUMO_publication.png, dpi=300

# =============================================================================
# Scene 3: Combined view (both orbitals, side by side)
# =============================================================================
disable lumo_label
enable homo_pos
enable homo_neg
enable lumo_pos  
enable lumo_neg

# Adjust transparency for combined view
set transparency, 0.4, homo_pos
set transparency, 0.4, homo_neg
set transparency, 0.4, lumo_pos
set transparency, 0.4, lumo_neg

scene combined_view, store

# Side-by-side grid view
set grid_mode, 1

# HOMO panel
set grid_slot, 1
scene homo_view, recall
enable homo_label
ray 300, 300

# LUMO panel  
set grid_slot, 2
scene lumo_view, recall
enable lumo_label
ray 300, 300

# Save combined figure
png Mol1_HOMO_LUMO_combined.png, dpi=300

# Reset to single view
set grid_mode, 0
scene combined_view, recall

# =============================================================================
# Animation: 360-degree rotation
# =============================================================================
# Create smooth rotation movie (6 seconds at 30 fps = 180 frames)
mset 1 x180

# Rotation around Y-axis
util.mroll 1, 1, 180

# Save movie frames
mpng Mol1_rotation_

# =============================================================================
# Final summary information
# =============================================================================
print "============================================="
print "Molecular Orbital Analysis Summary"
print "============================================="
print "Molecule ID: Mol1"
print "HOMO Energy: -7.403 eV"
print "LUMO Energy: 2.229 eV" 
print "HOMO-LUMO Gap: 9.632 eV"
print "Total Energy: -154.845318 Hartree"
print "Dipole Moment: 1.638 Debye"
print "============================================="

# Useful commands for manual exploration:
# scene homo_view, recall    # Show HOMO
# scene lumo_view, recall    # Show LUMO  
# scene combined_view, recall # Show both
# set transparency, X, object_name  # Adjust transparency (0-1)
# set isosurface_level, X, object_name  # Adjust isosurface level
